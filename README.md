# CVE-2017-8890

This CVE is adapted for Fujitsu Arrows NX F-01F with KitKat firmware (Android 4.4.2, build # V10R22A, kernel version 3.4.0). The original code is written by [thinkycx](https://github.com/thinkycx).

The exp works on foresaid device only! It definitely **won't work** on any other smartphone without altering the memory addresses, structs etc. in the code. The same applies to earlier builds of F-01F, i.e. JellyBean ones. They could be easier to adapt though.

**N.B.**: It also partially patches fjsec LSM, so you could use [LSM Trasher](https://github.com/dadreamer/lsm_trasher "LSM Trasher") later to disable the rest of the protection.

Known issues:
- Sometimes it makes the phone reboot on _"try to read..."_ operation - just wait some time (5 to 10 mins) after reboot and try again;
- It always makes the phone reboot, when done with the root shell (e.g., issue _exit_ cmd or close the console window);
- Even if you manage to install `su`, it will launch with a limited set of capabilities, because both fjsec and SELinux are in effect after the system restart.

------------
Related documents (as per by the author):
- [ubuntu 内核双机调试方法](https://thinkycx.me/posts/2018-08-08-how-to-debug-ubuntu-kernel-with-2-VM.html)
- [CVE-2017-8890漏洞分析和利用-概览篇](https://thinkycx.me/posts/2018-10-30-a-glance-at-CVE-2017-8890.html)
- [CVE-2017-8890 漏洞分析 原理篇](https://thinkycx.me/posts/2018-08-08-CVE-2017-8890-analysis.html)
- [CVE-2017-8890 漏洞利用（root ubuntu 16.04@kernel 4.10）](https://thinkycx.me/posts/2018-08-09-CVE-2017-8890-root-ubuntu-16.04-kernel-4.10.html)
- [CVE-2017-8890 漏洞利用 (root nexus6p@kernel 3.10)](https://thinkycx.me/posts/2018-08-09-CVE-2017-8890-root-nexus6p-kernel-3.10.html)
